<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="stylesheet" href="css/cadastro.css">
</head>

<body>
    <div class="div_fechar_alerta" onclick="fechar_alerta()" style="display: none " id="div_fechar_alerta">
    </div>
    <div class="alerta_lofhel" style="display: none;" id="alerta_grupo3">
        <div>
            <img src="../deshbord/imagens-deshbord/logotipo01.png" id="logotipo_alerta">
            <img src="../deshbord/imagens-deshbord/exit.png" id="icone_fechar_alerta" alt="" onclick="fechar_alerta()">
        </div>
        <p id="alerta_titulo">
            Cadastro realizado com sucesso
        </p>


        <p id="alerta_sub"><a href="../login.html">
                Faça o seu login</a>
        </p>


    </div>
    <div class="container">
        <div class="left-content">
            <div class="buttonback">
                <a href="inicio.html"><img src="./assets/back button.png" alt="backbutton"></a>
            </div>
            <div class="position-logotipo">
                <a href="inicio.html"><img class="size-logotipo" src="./assets/logotipo01.png" alt="logotipo01"></a>
            </div>
            <div class="title">
                <span class="size-title">
                    SEJA BEM-VINDO <br> _
                </span>
            </div>
            <div class="slogan">
                <span class="size-slogan">
                    Preservando a excelência do vinho<br> através da tecnologia
                </span>
            </div>
        </div>

        <div class="right-content">
            <div class="titulo-right">
                <h3><b>Faça seu cadastro</b></h3>
            </div>
            <div class="inputs">
                <div>
                    <p id="texto_user">Nome</p>
                    <input type="text" id="ipt_user" placeholder="Nome" oninput="digitando_cad()"><br>
                    <span id="nome_erro" style="display:none;">Preencha o nome</span>
                </div>

                <div>
                    <p id="texto_cnpj">CNPJ</p>
                    <input type="text" id="ipt_cnpj" placeholder="CNPJ" oninput="digitando_cad()"><br>
                    <span id="cnpj_erro" style="display:none;">CNPJ inválido</span>
                </div>

                <div>
                    <p id="texto_email">E-mail</p>
                    <input type="text" id="ipt_email" placeholder="Email" oninput="digitando_cad()"><br>
                    <span id="email_erro" style="display:none;">E-mail inválido</span>
                </div>

                <div>
                    <p id="texto_senha">Senha</p>
                    <input type="password" id="ipt_senha" placeholder="Senha" oninput="digitando_cad()"><br>
                    <span id="senha_erro" style="display:none;">Senha inválida</span>
                </div>

                <div>
                    <p id="texto_confirmarsenha">Confirmar Senha</p>
                    <input type="password" id="ipt_confirmarsenha" placeholder="Confirmar Senha"
                        oninput="digitando_cad()"><br>
                    <span id="conf_senha_erro" style="display:none;">As senhas não coincidem</span>
                    <div id="recomendacao_senha">
                        <ul>
                            <li id="minusculo">Um caractere minúsculo </li>
                            <li id="maiusculo">Um caractere maiúsculo</li>
                            <li id="numero">Um número</li>
                        </ul>
                        <ul>
                            <li id="especial">Um caractere especial</li>
                            <li id="minimo">Mínimo de 8 caracteres</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="botom_esqueci">
                <button onclick="registro()">Cadastrar</button>
                <span id="campos_vazios" style="display:none;">Preencha todos os campos!</span>
                <span style="display: flex; color: white;">
                    <p>Já possui uma conta? <a class="txt-laranja" href="login.html">Faça login</a></p>
                </span>
            </div>
        </div>
    </div>

    <script>
        function digitando_cad() {
            // Resetando estilos de erro
            nome_erro.style.display = "none";
            cnpj_erro.style.display = "none";
            email_erro.style.display = "none";
            senha_erro.style.display = "none";
            conf_senha_erro.style.display = "none";
            campos_vazios.style.display = "none";

            // Estilizando inputs preenchidos
            ipt_user.value !== '' && (texto_user.style.color = "#DEA976", ipt_user.style.borderBottom = "1px solid #DEA976");
            ipt_cnpj.value !== '' && (texto_cnpj.style.color = "#DEA976", ipt_cnpj.style.borderBottom = "1px solid #DEA976");
            ipt_email.value !== '' && (texto_email.style.color = "#DEA976", ipt_email.style.borderBottom = "1px solid #DEA976");
            ipt_senha.value !== '' && (texto_senha.style.color = "#DEA976", ipt_senha.style.borderBottom = "1px solid #DEA976", recomendacao_senha.style.color = "grey");
            ipt_confirmarsenha.value !== '' && (texto_confirmarsenha.style.color = "#DEA976", ipt_confirmarsenha.style.borderBottom = "1px solid #DEA976");

            // Verificação dos requisitos da senha
            const senha = ipt_senha.value;
            const especiais = "!#$%&'()*+,-./:;<=>?@[]^_`{|}~´`^~¨§ªº°";

            let temMaiusculo = false, temMinusculo = false, temNumero = false, temEspecial = false;

            for (let i = 0; i < senha.length; i++) {
                const c = senha[i];
                if (c >= 'A' && c <= 'Z') temMaiusculo = true;
                if (c >= 'a' && c <= 'z') temMinusculo = true;
                if (!isNaN(c)) temNumero = true;
                if (especiais.includes(c)) temEspecial = true;
            }

            maiusculo.style.color = temMaiusculo ? "#DEA976" : "grey";
            minusculo.style.color = temMinusculo ? "#DEA976" : "grey";
            numero.style.color = temNumero ? "#DEA976" : "grey";
            especial.style.color = temEspecial ? "#DEA976" : "grey";
            minimo.style.color = senha.length >= 8 ? "#DEA976" : "grey";
        }

        function registro() {
            const user = ipt_user.value.trim();
            const cnpj = ipt_cnpj.value.trim();
            const email = ipt_email.value.trim();
            const senha = ipt_senha.value;
            const confirmarSenha = ipt_confirmarsenha.value;
            let validado = true;

            if (!user || !cnpj || !email || !senha || !confirmarSenha) {
                campos_vazios.style.display = "flex";
            }
        }



        function registro() {
            var user = ipt_user.value;
            var cnpj = ipt_cnpj.value;
            var email = ipt_email.value;
            var senha = ipt_senha.value;
            var confirmarsenha = ipt_confirmarsenha.value;
            var validado = true;
            var temnumero = false;
            var temletra = false;
            var temletramaiscula = false;
            var temespaco = false;

            //if (user=="Jhoel") {
            // div_fechar_alerta.style="display:flex"
            //     alerta_grupo3.style="display:flex"
            //   }
            // Validando campos que estão vazios

            if (user == "" && cnpj == "" && email == "" && senha == "" && confirmarsenha == "") {
                campos_vazios.style = "display:flex"
            } else {
                // Validando usuario

                //  for (var i = 0; i < user.length; i++) {
                //      if (user[i] === " ") {
                //          temespaco = true;
                //      }
                // }

                if (user === "") {
                    nome_erro.style = "display:flex"
                    validado = false;
                } else if (user.length <= 3) {
                    nome_erro.innerHTML = 'Erro... Não pode ter menos de 3 caracteres no usuário';
                    nome_erro.style = "display:flex"
                    validado = false;
                }

                // CNPJ
                const cnpjHasLetters = /[a-zA-Z]/.test(cnpj);
                const cnpjHasSpecials = /[^0-9]/.test(cnpj);

                if (cnpj.length !== 14 || cnpjHasLetters || cnpjHasSpecials) {
                    cnpj_erro.innerHTML = 'CNPJ deve ter 14 números e não conter letras ou símbolos.';
                    cnpj_erro.style.display = "flex";
                    validado = false;
                }

                // E-mail
                const arrobas = [...email].filter(c => c === '@').length;
                if (!email.includes('@') || arrobas > 1 || !email.endsWith('.com') || email.includes(' ')) {
                    email_erro.innerHTML = 'Email inválido. Ex: exemplo@gmail.com';
                    email_erro.style.display = "flex";
                    validado = false;
                }

                // Senha
                const especiais = "!#$%&'()*+,-./:;<=>?@[]^_`{|}~´`^~¨§ªº°";
                let temMaiusculo = false, temMinusculo = false, temNumero = false, temEspecial = false;

                temespaco = false;

                for (var i = 0; i < email.length; i++) {
                    if (email[i] === " ") {
                        temespaco = true;
                    }
                }
                var contandor_arroba = 0
                // verificar se tem mais de um @ 
                for (let i = 0; i < email.length; i++) {
                    if (email[i].includes('@')) {
                        contandor_arroba++
                    }
                }

                if (!temMaiusculo || !temMinusculo || !temNumero || !temEspecial || senha.length < 8) {
                    console.log(senha.length)
                    console.log(temMaiusculo)

                    senha_erro.innerHTML = 'Senha deve conter: 1 maiúscula, 1 minúscula, 1 número, 1 símbolo e mínimo 8 caracteres.';
                    senha_erro.style.display = "flex";
                    validado = false;
                }

                // Confirmar senha
                if (senha !== confirmarSenha) {
                    conf_senha_erro.innerHTML = "As senhas não coincidem.";
                    conf_senha_erro.style.display = "flex";
                    validado = false;
                }

                if (validado) {
                    div_fechar_alerta.style = "display:flex"
                    alerta_grupo3.style = "display:flex"
                }
            }
        }
        function fechar_alerta() {
            alerta_grupo3.style = "display:none"
            div_fechar_alerta.style = "display:none"
        }

    </script>